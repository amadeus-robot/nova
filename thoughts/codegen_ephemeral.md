should be able to compile functions as lambdas
passing an env argument first that holds local refs or all the refs

